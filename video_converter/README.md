# PSP Video Converter
Небольшой Python-скрипт для автоматической конвертации видеофайлов в формат, совместимый с PlayStation Portable (PSP), с генерацией миниатюр. Поддерживает все модели PSP, включая режим TV-выхода.

[Русский](README.md) | [English](README_EN.md)

## Возможности
- Конвертация всех видео из `input_videos` в `.mp4`, совместимый с PSP
- Создание `.thm` миниатюры для каждого видео (по умолчанию с 1-й секунды)
- Поддержка запуска через Docker
- Выбор оптимальных настроек в зависимости от модели PSP
- Поддержка TV-режима (`720x480`) для вывода видео на телевизор

## Быстрый старт

### 1. Собери Docker-образ:
```bash
docker build -t psp-converter .
````

### 2. Подготовь папки:
Создай папки `input_videos` и `output_videos` рядом с `Dockerfile` и положи видеофайлы в `input_videos`.

### 3. Запусти контейнер:
```bash
docker run --rm \
  -v $(pwd)/input_videos:/app/input_videos \
  -v $(pwd)/output_videos:/app/output_videos \
  -e PSP_MODEL=3000 \
  psp-converter
```

### 4. (Опционально) Включи TV-режим:
```bash
-e TV_OUT=true
```
Это установит разрешение видео в `720x480`, чтобы его можно было воспроизводить на телевизоре c PSP.

## Поддерживаемые модели PSP
| Модель PSP | Разрешение (по умолчанию) | Видео битрейт | CRF | Поддержка TV-выхода |
| ---------- | ------------------------- | ------------- | --- | ------------------- |
| `1000`     | 368×208                   | 768k          | 25  | ❌                   |
| `2000`     | 480×272 / 720×480         | 1024k         | 23  | ✅                   |
| `3000`     | 480×272 / 720×480         | 1500k         | 21  | ✅                   |

> ⚠️ PSP-1000 имеет ограничения по декодированию: не поддерживает видео выше 368×208 и H.264 выше Level 1.3.

## Переменные окружения
| Переменная             | Назначение                                                                                 | Значение по умолчанию |
| ---------------------- |--------------------------------------------------------------------------------------------| --------------------- |
| `PSP_MODEL`            | Модель PSP: `1000`, `2000`, `3000`                                                         | `1000`                |
| `TV_OUT`               | `true`, чтобы включить 720×480 для вывода на ТВ (поддерживается только на PSP 2000 и 3000) | `false`               |
| `PSP_RESOLUTION`       | Переопределение разрешения вручную                                                         | авто                  |
| `PSP_CRF`              | CRF (качество от 0 (лучшее) до 51 (худшее))                                                | авто                  |
| `PSP_VIDEO_BITRATE`    | Битрейт видео (например, `1024k`)                                                          | авто                  |
| `PSP_AUDIO_BITRATE`    | Аудио битрейт (например, `128k`)                                                           | `128k`                |
| `PSP_AUDIO_HZ`         | Частота аудио (например, `48000`)                                                          | `48000`               |
| `PSP_THUMBNAIL_SECOND` | Секунда, с которой делается кадр для миниатюры                                             | `1`                   |

## Выходные файлы
* Видео в `.mp4`, совместимом с PSP
* Миниатюра в `.thm`, созданная с заданной секунды

## Благодарности
Спасибо проекту [VidToPSP-ffmpeg](https://github.com/wanesty/VidToPSP-ffmpeg) от [wabesty](https://github.com/wanesty), 
которым я вдохновлялся и взял из него за основу параметры для ffmpeg